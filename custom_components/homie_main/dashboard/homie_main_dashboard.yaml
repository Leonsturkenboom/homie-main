# Homie Main Dashboard
# Copy this content to your Lovelace dashboard raw configuration
# Requires: mini-graph-card, auto-entities (HACS)
#
# PRD Colors:
# - Use: rgba(127, 17, 224, 1) - purple
# - Solar: rgba(233, 188, 5, 1) - yellow
# - Price: rgba(224, 75, 30, 1) - orange
#
# Sensors used:
# - Graph lines: EC power sensors (always W for history)
# - Display values: HM display sensors (dynamic W/kWh/€)
# - Price line: sensor.ep_purchase_price, display: sensor.hm_price_day_curve

title: Main
icon: mdi:home
views:
  - title: Main
    path: main
    icon: mdi:home
    cards:
      # ============================================
      # Full layout in grid
      # ============================================
      - type: grid
        columns: 1
        cards:
          # Title
          - type: heading
            icon: mdi:home-analytics
            heading: Main
            heading_style: title

          # Schedule + Eenheid selector
          - type: grid
            columns: 2
            square: false
            cards:
              - type: entity
                entity: select.hm_home_status
                name: Schedule
                state_color: true
              - type: entity
                entity: select.hm_visualization
                name: Eenheid
                state_color: true

          # Three graphs horizontal
          - type: horizontal-stack
            cards:
              # Use Graph (Purple)
              # Line: EC power sensor (always W), Value: HM display sensor (W/kWh/€)
              - type: custom:mini-graph-card
                name: Use
                icon: mdi:flash
                entities:
                  - entity: sensor.ec_total_power_use
                    name: Use
                    color: "rgba(127, 17, 224, 1)"
                    show_fill: false
                    show_state: false
                  - entity: sensor.hm_use_display
                    name: Display
                    show_line: false
                    show_points: false
                    show_state: true
                  - entity: binary_sensor.hm_nighttime
                    name: Nighttime
                    color: transparent
                    show_line: false
                    show_points: false
                    show_state: false
                    y_axis: secondary
                line_width: 8
                font_size: 80
                hours_to_show: 24
                points_per_hour: 2
                decimals: 1
                show:
                  legend: false
                  labels: false
                  labels_secondary: false
                  extrema: true
                  state: true
                tooltip: false

              # Solar Graph (Yellow)
              # Line: EC solar power sensor (always W), Value: HM display sensor (W/kWh/€)
              - type: custom:mini-graph-card
                name: Solar
                icon: mdi:solar-power
                entities:
                  - entity: sensor.ec_solar_power
                    name: Solar
                    color: "rgba(233, 188, 5, 1)"
                    show_fill: false
                    show_state: false
                  - entity: sensor.hm_solar_display
                    name: Display
                    show_line: false
                    show_points: false
                    show_state: true
                  - entity: binary_sensor.hm_nighttime
                    name: Nighttime
                    color: transparent
                    show_line: false
                    show_points: false
                    show_state: false
                    y_axis: secondary
                line_width: 8
                font_size: 80
                hours_to_show: 24
                points_per_hour: 2
                decimals: 1
                show:
                  legend: false
                  labels: false
                  labels_secondary: false
                  extrema: true
                  state: true
                tooltip: false

              # Price Graph (Orange)
              # Line: EP purchase price sensor (has recorder history), Value: HM display sensor
              - type: custom:mini-graph-card
                name: Price
                icon: mdi:currency-eur
                entities:
                  - entity: sensor.ep_purchase_price
                    name: Price
                    color: "rgba(224, 75, 30, 1)"
                    show_fill: false
                    show_state: false
                  - entity: sensor.hm_price_day_curve
                    name: Display
                    show_line: false
                    show_points: false
                    show_state: true
                  - entity: binary_sensor.hm_nighttime
                    name: Nighttime
                    color: transparent
                    show_line: false
                    show_points: false
                    show_state: false
                    y_axis: secondary
                line_width: 8
                font_size: 80
                hours_to_show: 24
                points_per_hour: 2
                decimals: 2
                show:
                  legend: false
                  labels: false
                  labels_secondary: false
                  extrema: true
                  state: false
                tooltip: false

          # Notifications (below graphs)
          - type: custom:auto-entities
            card:
              type: entities
              title: Notifications
              show_header_toggle: false
              state_color: true
              show_state: true
            filter:
              include:
                - domain: sensor
                  name: "/^(Alarm|Warning|Info|Tip|Award)/"
              exclude:
                - state: "off"
                - state: unknown
                - state: unavailable
            show_empty: true
            sort:
              method: last_changed
              reverse: true
